<?php
register_nav_menus(array('primary'=>__('Верхнее меню'),'footer_menu'=>__('Подвал меню')));
if(!defined('ABSPATH')) exit;class wp_bootstrap_navwalker extends Walker_Nav_Menu {public function start_lvl( &$output, $depth = 0, $args = array() ) {$indent = str_repeat( "\t", $depth );$output .= "\n$indent<ul role=\"menu\" class=\" dropdown-menu\">\n";}public function start_el( &$output, $item, $depth = 0, $args = array(), $id = 0 ) {$indent = ( $depth ) ? str_repeat( "\t", $depth ) : '';if ( strcasecmp( $item->attr_title, 'divider' ) == 0 && $depth === 1 ) {$output .= $indent . '<li role="presentation" class="divider">';} else if ( strcasecmp( $item->title, 'divider') == 0 && $depth === 1 ) {$output .= $indent . '<li role="presentation" class="divider">';} else if ( strcasecmp( $item->attr_title, 'dropdown-header') == 0 && $depth === 1 ) {$output .= $indent . '<li role="presentation" class="dropdown-header">' . esc_attr( $item->title );} else if ( strcasecmp($item->attr_title, 'disabled' ) == 0 ) {$output .= $indent . '<li role="presentation" class="disabled"><a href="#">' . esc_attr( $item->title ) . '</a>';} else {$class_names = $value = '';$classes = empty( $item->classes ) ? array() : (array) $item->classes;$classes[] = 'menu-item-' . $item->ID;$class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item, $args ) );if($args->has_children && $depth === 0) { $class_names .= ' dropdown'; } elseif($args->has_children && $depth > 0) { $class_names .= ' dropdown-submenu'; }if ( in_array( 'current-menu-item', $classes ) )$class_names .= ' active';if ( in_array('fa', $classes)) {$key = array_search('fa', $classes);$icon = $classes[$key + 1];$class_names = str_replace($classes[$key+1], '', $class_names);$class_names = str_replace($classes[$key], '', $class_names);}$class_names = $class_names ? ' class="' . esc_attr( $class_names ) . '"' : '';$id = apply_filters( 'nav_menu_item_id', 'menu-item-'. $item->ID, $item, $args );$id = $id ? ' id="' . esc_attr( $id ) . '"' : '';$output .= $indent . '<li' . $id . $value . $class_names .'>';$atts = array();$atts['title'] = ! empty( $item->title )? $item->title: '';$atts['target'] = ! empty( $item->target )? $item->target: '';$atts['rel'] = ! empty( $item->xfn )? $item->xfn: '';if ( $args->has_children ) {$atts['href'] = '#';$atts['data-toggle']= 'dropdown';$atts['class']= 'dropdown-toggle';} else {$atts['href'] = ! empty( $item->url ) ? $item->url : '';}$atts = apply_filters( 'nav_menu_link_attributes', $atts, $item, $args );$attributes = '';foreach ( $atts as $attr => $value ) {if ( ! empty( $value ) ) {$value = ( 'href' === $attr ) ? esc_url( $value ) : esc_attr( $value );$attributes .= ' ' . $attr . '="' . $value . '"';}}$item_output = $args->before;if ( ! empty( $icon ) )$item_output .= '<a'. $attributes .'><span class="fa ' . esc_attr( $icon ) . '"></span>&nbsp;';else$item_output .= '<a'. $attributes .'>';$item_output .= $args->link_before . apply_filters( 'the_title', $item->title, $item->ID ) . $args->link_after;$item_output .= ( $args->has_children && 0 === $depth ) ? ' <span class="caret"></span></a>' : '</a>';$item_output .= $args->after;$output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );}}public function display_element( $element, &$children_elements, $max_depth, $depth, $args, &$output ) { if ( ! $element ) return; $id_field = $this->db_fields['id']; if ( is_object( $args[0] ) ) $args[0]->has_children = ! empty( $children_elements[ $element->$id_field ] ); parent::display_element( $element, $children_elements, $max_depth, $depth, $args, $output ); }public static function fallback( $args ) {if ( current_user_can( 'manage_options' ) ) {extract( $args );$fb_output = null;if ( $container ) {$fb_output = '<' . $container;if ( $container_id )$fb_output .= ' id="' . $container_id . '"';if ( $container_class )$fb_output .= ' class="' . $container_class . '"';$fb_output .= '>';}$fb_output .= '<ul';if ( $menu_id )$fb_output .= ' id="' . $menu_id . '"';if ( $menu_class )$fb_output .= ' class="' . $menu_class . '"';$fb_output .= '>';$fb_output .= '<li><a href="' . admin_url( 'nav-menus.php' ) . '">Add a menu</a></li>';$fb_output .= '</ul>';if ( $container )$fb_output .= '</' . $container . '>';echo $fb_output;}}}
add_action( 'init', 'create_post_type' );
function create_post_type() { 
register_post_type( 'settings', array( 'labels' => array( 'name' => __( 'Настройки' ), 'singular_name' => __( 'Settings' ) ), 'public' => true, 'has_archive' => false, ) );
}
add_action('admin_head', 'my_custom_fonts');function my_custom_fonts() {echo '<link rel="stylesheet" href="';bloginfo('template_directory');echo '/admin.css">';}
function wp_corenavi() { global $wp_query; $pages = ''; $max = $wp_query->max_num_pages; if (!$current = get_query_var('paged')) $current = 1; $a['base'] = str_replace(999999999, '%#%', get_pagenum_link(999999999)); $a['total'] = $max; $a['current'] = $current; $total = 0; $a['mid_size'] = 3; $a['end_size'] = 1; $a['prev_text'] = '&laquo;'; $a['next_text'] = '&raquo;'; if ($max > 1) echo '<nav aria-label="Page navigation" style="text-align: center;"><ul class="pagination">'; if ($total == 1 && $max > 1) $pages = '<span class="pages">Страница ' . $current . ' из ' . $max . '</span>'."\r\n"; echo $pages . '<li>'.paginate_links($a).'</li>'; if ($max > 1) echo '</ul></nav>';}
add_action( 'wp_print_styles', 'my_deregister_styles', 100 );function my_deregister_styles(){ wp_deregister_style( 'common' );}
add_theme_support('post-thumbnails');if ( function_exists('add_theme_support') ) {add_theme_support('post-thumbnails');}
add_filter('pre_get_posts',function ($query) {if ($query->is_search && !is_admin() )$query->set('post_type',array('post','page'));return $query;});
?>

